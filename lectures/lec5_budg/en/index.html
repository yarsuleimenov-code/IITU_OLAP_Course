<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infographics: Budgeting and Plan-Fact Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; 
            color: #1f2937;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .card {
            background-color: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .header-bg {
            background: linear-gradient(135deg, #6ac1e3, #5FA6C7); 
        }
        
        .ibp-step {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.3s;
            font-size: 0.875rem;
        }
        .ibp-active-budget {
            background-color: #58508d;
            color: white;
            box-shadow: 0 4px 6px rgba(88, 80, 141, 0.4);
        }

        /* PDCA cycle styles */
        .pdca-step {
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-align: center; 
            border-width: 0;
            box-shadow: none; 
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%; 
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .pdca-step:hover {
            transform: scale(1.03); 
            box-shadow: 0 8px 10px -3px rgba(0, 0, 0, 0.15);
        }
        .pdca-P { background-color: #58508d; color: white; } 
        .pdca-D { background-color: #ff6361; color: white; }
        .pdca-C { background-color: #ffa600; color: white; }
        .pdca-A { background-color: #10b981; color: white; } 
        
        /* 2x2 Grid Layout for PDCA */
        .pdca-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 1.5rem;
            align-items: stretch;
        }
        .grid-P { grid-area: 1 / 1 / 2 / 2; }
        .grid-D { grid-area: 1 / 2 / 2 / 3; }
        .grid-C { grid-area: 2 / 2 / 3 / 3; }
        .grid-A { grid-area: 2 / 1 / 3 / 2; }

        .pdca-wrap {
            position: relative;
            overflow: visible;
        }
        
        /* Mobile Layout */
        @media (max-width: 768px) {
            .pdca-grid {
                grid-template-columns: 1fr; 
                grid-template-rows: auto;
                gap: 1rem;
            }
            .grid-P, .grid-D, .grid-C, .grid-A {
                grid-area: auto;
            }
            .pdca-step {
                text-align: left;
                padding: 1rem;
                border-left: 4px solid;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); 
            }
            .pdca-step h3, .pdca-step p {
                color: #1f2937; 
            }
             .pdca-P { border-color: #58508d; background-color: #eef2ff; color: #58508d; }
             .pdca-D { border-color: #ff6361; background-color: #fff1f2; color: #ff6361; }
             .pdca-C { border-color: #ffa600; background-color: #fff7ed; color: #ffa600; }
             .pdca-A { border-color: #10b981; background-color: #f0fff4; color: #10b981; }
        }
    </style>
</head>
<body class="text-gray-800 p-4 sm:p-8">

    <div class="container mx-auto max-w-5xl">

        <!-- Back Button -->
        <div class="mb-4">
            <a href="https://yarsuleimenov-code.github.io/IITU_OLAP_Course/en/index.html" class="inline-flex items-center text-sky-700 hover:text-sky-900 transition-colors font-semibold">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                <span>Back to Lecture List</span>
            </a>
        </div>
        
        <header class="text-center mb-12 p-8 rounded-2xl header-bg text-white shadow-xl">
            <img src="/IITU_OLAP_Course/assets/Logo-white.png"
                 alt="Casplan Logo"
                 class="mx-auto mb-6 h-16">
            <h1 class="text-3xl md:text-5xl font-bold mb-2">Budgeting and Plan-Fact Analysis</h1>
            <p class="text-lg md:text-xl mt-2 text-sky-200">Financial control in IBP: from Excel sheets to a unified enterprise management system.</p>
        </header>

        <!-- IBP Cycle Indicator -->
        <div class="mb-10 p-4 bg-white rounded-lg shadow-md border-b-2 border-gray-100 overflow-x-auto">
            <h3 class="text-sm font-bold text-gray-700 mb-2">Our Path in IBP</h3>
            <div class="flex space-x-4 items-center justify-between min-w-max">
                 <span class="ibp-step bg-gray-200 text-gray-600">S&OP (Demand)</span>
                <span class="text-gray-400">‚Üí</span>
                <span class="ibp-step bg-gray-200 text-gray-600">Logistics (Supply)</span>
                <span class="text-gray-400">‚Üí</span>
                <span class="ibp-step ibp-active-budget">Budgeting</span>
                <span class="text-gray-400">‚Üí</span>
                <span class="ibp-step bg-gray-200 text-gray-600">Financial Analysis</span>
            </div>
        </div>

        <main class="space-y-10">
            
            <!-- SECTION I: The Excel Problem -->
            <section id="excel-problem">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#ff6361]">I. The Excel Problem: Loss of the "Single Source of Truth"</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                     <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl mb-3 block">‚ùå</span>
                        <h3 class="text-lg font-semibold text-[#ff6361]">Broken Formulas</h3>
                        <p class="text-sm text-gray-600">Up to 90% of complex Excel models contain errors, leading to incorrect decisions.</p>
                    </div>
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl mb-3 block">üìß</span>
                        <h3 class="text-lg font-semibold text-[#ffa600]">Version Chaos</h3>
                        <p class="text-sm text-gray-600">Inability to compare "Budget_final" with "Forecast_Q3" due to scattered files in email.</p>
                    </div>
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl mb-3 block">‚ÜîÔ∏è</span>
                        <h3 class="text-lg font-semibold text-[#58508d]">Connection Gap</h3>
                        <p class="text-sm text-gray-600">The sales plan is not linked to the procurement plan. There is no automatic recalculation.</p>
                    </div>
                </div>
            </section>

            <!-- SECTION II: The Three Pillars of the Budget -->
            <section id="budget-types">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#003f5c]">II. The Three Pillars of the Budget</h2>
                <p class="max-w-3xl mx-auto text-center text-gray-600 mb-8">The budget model in an OLAP system links three main financial statements, providing a complete picture of the company's activities. Success depends on their integration.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="card p-6 border-t-4 border-[#ff6361]">
                        <span class="text-4xl mb-3 block">üìà</span>
                        <h3 class="text-xl font-semibold mb-2 text-[#ff6361]">Operating Budget (P&L)</h3>
                        <p class="text-gray-600">Reflects revenues and expenses from core operations. Answers the question: <strong>How profitable are we?</strong></p>
                    </div>
                    <div class="card p-6 border-t-4 border-[#ffa600]">
                        <span class="text-4xl mb-3 block">üõ†Ô∏è</span>
                        <h3 class="text-xl font-semibold mb-2 text-[#ffa600]">Investment Budget (CAPEX)</h3>
                        <p class="text-gray-600">Plan for capital expenditures (CAPEX) on assets: equipment, IT systems. Answers the question: <strong>Where are we investing for growth?</strong></p>
                    </div>
                    <div class="card p-6 border-t-4 border-[#58508d]">
                        <span class="text-4xl mb-3 block">üíµ</span>
                        <h3 class="text-xl font-semibold mb-2 text-[#58508d]">Financial Budget (Cash Flow)</h3>
                        <p class="text-gray-600">Tracks the actual movement of cash. Answers the question: <strong>Do we have enough cash to pay the bills?</strong></p>
                    </div>
                </div>
            </section>
            
            <section id="plan-fact">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#003f5c]">III. Plan-Fact: Control and Accountability</h2>
                <p class="max-w-3xl mx-auto text-center text-gray-600 mb-8">Plan-fact analysis is not just a report, but an early warning system. OLAP automatically compares the approved budget with actual data from the ERP.</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card lg:col-span-2 p-6">
                        <h3 class="text-xl font-semibold mb-4 text-[#003f5c]">Variance Analysis by Item (Plan vs. Actual)</h3>
                        <p class="text-sm text-gray-500 mb-4">Comparison of planned and actual costs for key line items.</p>
                        <div class="chart-container"><canvas id="planFactChart"></canvas></div>
                    </div>
                    
                    <!-- KPI Tiles -->
                    <div class="lg:col-span-1 space-y-4">
                        <div class="card p-6 bg-red-50 border-l-4 border-red-500">
                            <p class="text-sm text-red-600 mb-1">Total EBITDA variance:</p>
                            <h4 class="text-3xl font-bold text-red-700">Œî = -1.2M</h4>
                            <p class="text-sm text-gray-600">Under-realized profit as of Q3 actuals</p>
                        </div>
                        <div class="card p-6 bg-green-50 border-l-4 border-green-500">
                             <p class="text-sm text-green-600 mb-1">Budget execution (overall):</p>
                            <h4 class="text-3xl font-bold text-green-700">% Execution = 112%</h4>
                            <p class="text-sm text-gray-600">Overspending relative to plan (in the risk zone)</p>
                        </div>
                        <div class="card p-6 bg-blue-50 border-l-4 border-blue-500">
                             <p class="text-sm text-blue-600 mb-1">Year-end forecast (Q4):</p>
                            <h4 class="text-3xl font-bold text-blue-700">Q4 Forecast Œî = -5%</h4>
                            <p class="text-sm text-gray-600">Need for immediate strategy correction</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- SECTION IV: Budgeting Goals and Objectives (PDCA Cycle) -->
            <section id="budget-goals">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#003f5c]">IV. Methodology and Logic of the Budgeting Process (PDCA Cycle)</h2>
                 <p class="max-w-3xl mx-auto text-center text-gray-600 mb-8">Budgeting is a continuous management process that goes beyond simple planning. It is a cycle of continuous improvement (Plan-Do-Check-Act).</p>
                
                <div class="pdca-wrap max-w-2xl mx-auto">
                    
                    <div class="pdca-grid">
                        
                        <!-- P. Plan (Top Left) -->
                        <div class="card pdca-step pdca-P grid-P">
                            <span class="text-6xl font-extrabold mb-1">P</span>
                            <h3 class="font-bold text-xl">Plan</h3>
                            <p class="text-sm opacity-90">Defining objectives and detailed plans to achieve them.</p>
                        </div>

                        <!-- D. Do (Top Right) -->
                        <div class="card pdca-step pdca-D grid-D">
                            <span class="text-6xl font-extrabold mb-1">D</span>
                            <h3 class="font-bold text-xl">Do</h3>
                            <p class="text-sm opacity-90">Tracking and recording actual indicators during budget execution.</p>
                        </div>
                        
                        <!-- A. Act (Bottom Left) -->
                        <div class="card pdca-step pdca-A grid-A">
                            <span class="text-6xl font-extrabold mb-1">A</span>
                            <h3 class="font-bold text-xl">Act</h3>
                            <p class="text-sm opacity-90">Making changes or revising the budget itself (Rolling Forecast).</p>
                        </div>

                        <!-- C. Check (Bottom Right) -->
                        <div class="card pdca-step pdca-C grid-C">
                            <span class="text-6xl font-extrabold mb-1">C</span>
                            <h3 class="font-bold text-xl">Check</h3>
                            <p class="text-sm opacity-90">Plan-fact analysis and identifying the root causes of variances (Drill-Down).</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- SECTION V: Data-Driven Management -->
            <section id="conclusion">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#003f5c]">V. Data-Driven Management</h2>
                <div class="card p-8 bg-[#58508d] text-white text-center">
                    <span class="text-6xl mb-4 block">üéØ</span>
                    <h3 class="text-2xl font-bold mb-3">Key Takeaway</h3>
                    <p class="text-lg mb-6">The budget is a management tool. OLAP turns plan-fact analysis into a decision-making system, allowing you to not just record errors, but to instantly find their root causes (Drill-Down).</p>
                    
                    <div class="flex justify-around items-center mt-6">
                        <div class="w-1/3">
                            <p class="text-4xl font-extrabold text-[#ffa600]">99%</p>
                            <p class="text-sm font-semibold mt-1">Drill-Down Speed</p>
                        </div>
                        <div class="w-1/3">
                            <p class="text-4xl font-extrabold text-[#ff6361]">4x</p>
                            <p class="text-sm font-semibold mt-1">Faster Planning Cycle</p>
                        </div>
                        <div class="w-1/3">
                            <p class="text-4xl font-extrabold text-[#6ac1e3]">1</p>
                            <p class="text-sm font-semibold mt-1">Single Source of Truth</p>
                        </div>
                    </div>
                </div>
            </section>

        </main>
        
        <!-- Footer -->
        <footer class="text-center mt-12 py-6 border-t border-gray-300">
            <p class="text-gray-600">The budget is the strategy; plan-fact analysis is the tool for managing it. OLAP makes this management transparent and accurate.</p>
            
            <div class="mt-6">
                <a href="https://yarsuleimenov-code.github.io/IITU_OLAP_Course/en/index.html"
                   class="inline-flex items-center px-6 py-3 bg-sky-600 text-white rounded-lg shadow hover:bg-sky-700 transition duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back to Lecture List
                </a>
            </div>
        </footer>

    </div>

    <script>
        const chartColors = {
            darkBlue: '#003f5c',
            purple: '#58508d',
            red: '#ff6361',
            orange: '#ffa600',
            textColor: 'rgba(0, 0, 0, 0.8)',
            gridColor: 'rgba(0, 0, 0, 0.1)'
        };

        /**
         * Function to wrap long labels for charts.
         * @param {string} label - Chart label.
         * @returns {string|string[]} - Label or array of strings for wrapping.
         */
        const wrapLabel = (label) => {
            const maxLength = 16;
            if (typeof label !== 'string' || label.length <= maxLength) {
                return label;
            }
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + ' ' + word).trim().length > maxLength) {
                    lines.push(currentLine.trim());
                    currentLine = word;
                } else {
                    currentLine = (currentLine + ' ' + word).trim();
                }
            }
            if (currentLine) {
                lines.push(currentLine.trim());
            }
            return lines;
        };
        
        /**
         * Callback to format Chart.js tooltip title.
         * @param {object[]} tooltipItems - Tooltip items.
         * @returns {string} - Formatted title.
         */
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        // Standard options for Chart.js
        const defaultChartOptions = {
            maintainAspectRatio: false,
            responsive: true,
            plugins: {
                legend: {
                    labels: {
                        color: chartColors.textColor
                    }
                },
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { color: chartColors.textColor },
                    grid: { color: chartColors.gridColor }
                },
                x: {
                    ticks: { color: chartColors.textColor },
                    grid: { color: chartColors.gridColor }
                }
            }
        };

        // Initialize Plan-Fact Chart
        const ctxPlanFact = document.getElementById('planFactChart');
        if (ctxPlanFact) {
            new Chart(ctxPlanFact, {
                type: 'bar',
                data: {
                    labels: [
                        'Revenue', 
                        'Cost of Goods Sold', 
                        'Selling Expenses', 
                        'Administrative Expenses'
                    ].map(wrapLabel),
                    datasets: [
                        {
                            label: 'Plan (K $)',
                            data: [3500, 1500, 450, 600],
                            backgroundColor: chartColors.darkBlue,
                        },
                        {
                            label: 'Actual (K $)',
                            data: [3150, 1650, 500, 550],
                            backgroundColor: chartColors.orange,
                        }
                    ]
                },
                options: {
                    ...defaultChartOptions,
                    indexAxis: 'y', // Horizontal bar chart
                    scales: {
                        x: {
                            ...defaultChartOptions.scales.x,
                            title: { display: true, text: 'Amount (K $)' },
                            ticks: {
                                callback: function(value) { return value + 'K'; }
                            }
                        },
                        y: {
                            ...defaultChartOptions.scales.y,
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        ...defaultChartOptions.plugins,
                        tooltip: {
                            callbacks: {
                                title: tooltipTitleCallback,
                                // Function to calculate and display variance in the footer
                                footer: (tooltipItems) => {
                                    const plannedItem = tooltipItems.find(item => item.dataset.label === 'Plan (K $)');
                                    const actualItem = tooltipItems.find(item => item.dataset.label === 'Actual (K $)');
                                    
                                    if (plannedItem && actualItem) {
                                        const plan = plannedItem.parsed.x;
                                        const actual = actualItem.parsed.x;
                                        const delta = actual - plan;
                                        const percent = (delta / plan) * 100;
                                        
                                        const sign = delta >= 0 ? '+' : '';
                                        const analysis = delta >= 0 ? ' (Overspent)' : ' (Under budget)';
                                        
                                        return [
                                            `Variance (Œî): ${sign}${delta.toFixed(0)}K $`,
                                            `% of Plan: ${sign}${percent.toFixed(1)}%` + analysis
                                        ];
                                    }
                                    return ''; 
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>

