<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞: –ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ü–ª–∞–Ω-—Ñ–∞–∫—Ç –ê–Ω–∞–ª–∏–∑</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; 
            color: #1f2937;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .card {
            background-color: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .header-bg {
            background: linear-gradient(135deg, #6ac1e3, #5FA6C7); 
        }
        
        .ibp-step {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.3s;
            font-size: 0.875rem;
        }
        .ibp-active-budget {
            background-color: #58508d;
            color: white;
            box-shadow: 0 4px 6px rgba(88, 80, 141, 0.4);
        }

        /* PDCA cycle styles */
        .pdca-step {
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-align: center; 
            border-width: 0;
            box-shadow: none; 
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%; 
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .pdca-step:hover {
            transform: scale(1.03); 
            box-shadow: 0 8px 10px -3px rgba(0, 0, 0, 0.15);
        }
        .pdca-P { background-color: #58508d; color: white; } 
        .pdca-D { background-color: #ff6361; color: white; }
        .pdca-C { background-color: #ffa600; color: white; }
        .pdca-A { background-color: #10b981; color: white; } 
        
        /* 2x2 Grid Layout for PDCA */
        .pdca-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 1.5rem;
            align-items: stretch;
        }
        .grid-P { grid-area: 1 / 1 / 2 / 2; }
        .grid-D { grid-area: 1 / 2 / 2 / 3; }
        .grid-C { grid-area: 2 / 2 / 3 / 3; }
        .grid-A { grid-area: 2 / 1 / 3 / 2; }

        .pdca-wrap {
            position: relative;
            overflow: visible;
        }
        
        /* –ú–æ–±–∏–ª—å–Ω—ã–π Layout */
        @media (max-width: 768px) {
            .pdca-grid {
                grid-template-columns: 1fr; 
                grid-template-rows: auto;
                gap: 1rem;
            }
            .grid-P, .grid-D, .grid-C, .grid-A {
                grid-area: auto;
            }
            .pdca-step {
                text-align: left;
                padding: 1rem;
                border-left: 4px solid;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); 
            }
            .pdca-step h3, .pdca-step p {
                color: #1f2937; 
            }
             .pdca-P { border-color: #58508d; background-color: #eef2ff; color: #58508d; }
             .pdca-D { border-color: #ff6361; background-color: #fff1f2; color: #ff6361; }
             .pdca-C { border-color: #ffa600; background-color: #fff7ed; color: #ffa600; }
             .pdca-A { border-color: #10b981; background-color: #f0fff4; color: #10b981; }
        }
    </style>
</head>
<body class="text-gray-800 p-4 sm:p-8">

    <div class="container mx-auto max-w-5xl">

        <!-- –ö–Ω–æ–ø–∫–∞ –ù–∞–∑–∞–¥ -->
        <div class="mb-4">
            <a href="https://yarsuleimenov-code.github.io/IITU_OLAP_Course/" class="inline-flex items-center text-sky-700 hover:text-sky-900 transition-colors font-semibold">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                <span>–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –ª–µ–∫—Ü–∏–π</span>
            </a>
        </div>
        
        <header class="text-center mb-12 p-8 rounded-2xl header-bg text-white shadow-xl">
            <img src="/IITU_OLAP_Course/assets/Logo-white.png"
                 alt="Casplan Logo"
                 class="mx-auto mb-6 h-16">
            <h1 class="text-3xl md:text-5xl font-bold mb-2">–ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ü–ª–∞–Ω-—Ñ–∞–∫—Ç –ê–Ω–∞–ª–∏–∑</h1>
            <p class="text-lg md:text-xl mt-2 text-sky-200">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å IBP: –æ—Ç —Ç–∞–±–ª–∏—Ü Excel –∫ –µ–¥–∏–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ–º.</p>
        </header>

        <!-- IBP Cycle Indicator -->
        <div class="mb-10 p-4 bg-white rounded-lg shadow-md border-b-2 border-gray-100 overflow-x-auto">
            <h3 class="text-sm font-bold text-gray-700 mb-2">–ù–∞—à –ü—É—Ç—å –≤ IBP</h3>
            <div class="flex space-x-4 items-center justify-between min-w-max">
                 <span class="ibp-step bg-gray-200 text-gray-600">S&OP (–°–ø—Ä–æ—Å)</span>
                <span class="text-gray-400">‚Üí</span>
                <span class="ibp-step bg-gray-200 text-gray-600">–õ–æ–≥–∏—Å—Ç–∏–∫–∞ (–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)</span>
                <span class="text-gray-400">‚Üí</span>
                <span class="ibp-step ibp-active-budget">–ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
                <span class="text-gray-400">‚Üí</span>
                <span class="ibp-step bg-gray-200 text-gray-600">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ê–Ω–∞–ª–∏–∑</span>
            </div>
        </div>

        <main class="space-y-10">
            
            <!-- –°–ï–ö–¶–ò–Ø I: –ü—Ä–æ–±–ª–µ–º–∞ Excel -->
            <section id="excel-problem">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#ff6361]">I. –ü—Ä–æ–±–ª–µ–º–∞ Excel: –ü–æ—Ç–µ—Ä—è "–ï–¥–∏–Ω–æ–π –ò—Å—Ç–∏–Ω—ã"</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                     <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl mb-3 block">‚ùå</span>
                        <h3 class="text-lg font-semibold text-[#ff6361]">–°–ª–æ–º–∞–Ω–Ω—ã–µ –§–æ—Ä–º—É–ª—ã</h3>
                        <p class="text-sm text-gray-600">–î–æ 90% —Å–ª–æ–∂–Ω—ã—Ö Excel-–º–æ–¥–µ–ª–µ–π —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—à–∏–±–∫–∏, –≤–µ–¥—É—â–∏–µ –∫ –Ω–µ–≤–µ—Ä–Ω—ã–º —Ä–µ—à–µ–Ω–∏—è–º.</p>
                    </div>
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl mb-3 block">üìß</span>
                        <h3 class="text-lg font-semibold text-[#ffa600]">–•–∞–æ—Å –í–µ—Ä—Å–∏–π</h3>
                        <p class="text-sm text-gray-600">–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ä–∞–≤–Ω–∏—Ç—å "–ë—é–¥–∂–µ—Ç_final" —Å "–ü—Ä–æ–≥–Ω–æ–∑_Q3" –∏–∑-–∑–∞ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø–æ—á—Ç–µ.</p>
                    </div>
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl mb-3 block">‚ÜîÔ∏è</span>
                        <h3 class="text-lg font-semibold text-[#58508d]">–†–∞–∑—Ä—ã–≤ –°–≤—è–∑–µ–π</h3>
                        <p class="text-sm text-gray-600">–ü–ª–∞–Ω –ø—Ä–æ–¥–∞–∂ –Ω–µ —Å–≤—è–∑–∞–Ω —Å –ø–ª–∞–Ω–æ–º –∑–∞–∫—É–ø–æ–∫. –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ—Å—á–µ—Ç–∞.</p>
                    </div>
                </div>
            </section>

            <!-- –°–ï–ö–¶–ò–Ø II: –¢—Ä–∏ –∫–∏—Ç–∞ –±—é–¥–∂–µ—Ç–∞ -->
            <section id="budget-types">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#003f5c]">II. –¢—Ä–∏ –∫–∏—Ç–∞ –±—é–¥–∂–µ—Ç–∞</h2>
                <p class="max-w-3xl mx-auto text-center text-gray-600 mb-8">–ë—é–¥–∂–µ—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –≤ OLAP-—Å–∏—Å—Ç–µ–º–µ —Å–≤—è–∑—ã–≤–∞–µ—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏. –£—Å–ø–µ—Ö –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="card p-6 border-t-4 border-[#ff6361]">
                        <span class="text-4xl mb-3 block">üìà</span>
                        <h3 class="text-xl font-semibold mb-2 text-[#ff6361]">–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π (–ë–î–† / P&L)</h3>
                        <p class="text-gray-600">–û—Ç—Ä–∞–∂–∞–µ—Ç –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: <strong>–ù–∞—Å–∫–æ–ª—å–∫–æ –º—ã –ø—Ä–∏–±—ã–ª—å–Ω—ã?</strong></p>
                    </div>
                    <div class="card p-6 border-t-4 border-[#ffa600]">
                        <span class="text-4xl mb-3 block">üõ†Ô∏è</span>
                        <h3 class="text-xl font-semibold mb-2 text-[#ffa600]">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π (–ë–ò–î)</h3>
                        <p class="text-gray-600">–ü–ª–∞–Ω –∫–∞–ø–∏—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ (CAPEX) –Ω–∞ –∞–∫—Ç–∏–≤—ã: –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, IT-—Å–∏—Å—Ç–µ–º—ã. –û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: <strong>–ö—É–¥–∞ –º—ã –≤–∫–ª–∞–¥—ã–≤–∞–µ–º—Å—è –¥–ª—è —Ä–æ—Å—Ç–∞?</strong></p>
                    </div>
                    <div class="card p-6 border-t-4 border-[#58508d]">
                        <span class="text-4xl mb-3 block">üíµ</span>
                        <h3 class="text-xl font-semibold mb-2 text-[#58508d]">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π (–ë–î–î–° / Cash Flow)</h3>
                        <p class="text-gray-600">–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤. –û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å: <strong>–•–≤–∞—Ç–∏—Ç –ª–∏ –¥–µ–Ω–µ–≥ –¥–ª—è –æ–ø–ª–∞—Ç—ã —Å—á–µ—Ç–æ–≤?</strong></p>
                    </div>
                </div>
            </section>
            
            <section id="plan-fact">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#003f5c]">III. –ü–ª–∞–Ω-–§–∞–∫—Ç: –ö–æ–Ω—Ç—Ä–æ–ª—å –∏ –ü—Ä–∞–≤–æ—Å—É–¥–∏–µ</h2>
                <p class="max-w-3xl mx-auto text-center text-gray-600 mb-8">–ü–ª–∞–Ω-—Ñ–∞–∫—Ç –∞–Ω–∞–ª–∏–∑ –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ—Ç—á–µ—Ç, –∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–Ω–µ–≥–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è. OLAP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ ERP.</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="card lg:col-span-2 p-6">
                        <h3 class="text-xl font-semibold mb-4 text-[#003f5c]">–ê–Ω–∞–ª–∏–∑ –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –ø–æ –°—Ç–∞—Ç—å—è–º (–ü–ª–∞–Ω vs. –§–∞–∫—Ç)</h3>
                        <p class="text-sm text-gray-500 mb-4">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤—ã—Ö –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞—Ç—Ä–∞—Ç –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º —Å—Ç–∞—Ç—å—è–º.</p>
                        <div class="chart-container"><canvas id="planFactChart"></canvas></div>
                    </div>
                    
                    <!-- KPI –ü–ª–∞—à–∫–∏ -->
                    <div class="lg:col-span-1 space-y-4">
                        <div class="card p-6 bg-red-50 border-l-4 border-red-500">
                            <p class="text-sm text-red-600 mb-1">–û–±—â–µ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤ EBITDA:</p>
                            <h4 class="text-3xl font-bold text-red-700">Œî = -1.2 –º–ª–Ω</h4>
                            <p class="text-sm text-gray-600">–ù–µ–¥–æ–ø–æ–ª—É—á–µ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –ø–æ —Ñ–∞–∫—Ç—É Q3</p>
                        </div>
                        <div class="card p-6 bg-green-50 border-l-4 border-green-500">
                             <p class="text-sm text-green-600 mb-1">–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞ (–≤ —Ü–µ–ª–æ–º):</p>
                            <h4 class="text-3xl font-bold text-green-700">% –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è = 112%</h4>
                            <p class="text-sm text-gray-600">–ü–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–ª–∞–Ω–∞ (–≤ –∑–æ–Ω–µ —Ä–∏—Å–∫–∞)</p>
                        </div>
                        <div class="card p-6 bg-blue-50 border-l-4 border-blue-500">
                             <p class="text-sm text-blue-600 mb-1">–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –∫–æ–Ω–µ—Ü –≥–æ–¥–∞ (Q4):</p>
                            <h4 class="text-3xl font-bold text-blue-700">–ü—Ä–æ–≥–Ω–æ–∑ Œî –Ω–∞ Q4 = -5%</h4>
                            <p class="text-sm text-gray-600">–ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- –°–ï–ö–¶–ò–Ø IV: –ó–∞–¥–∞—á–∏ –∏ –¶–µ–ª–∏ –ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–¶–∏–∫–ª PDCA) -->
            <section id="budget-goals">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#003f5c]">IV. –ó–∞–¥–∞—á–∏ –∏ –¶–µ–ª–∏ –ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–¶–∏–∫–ª PDCA)</h2>
                 <p class="max-w-3xl mx-auto text-center text-gray-600 mb-8">–ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ —Ü–∏–∫–ª –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è (Plan-Do-Check-Act).</p>
                
                <div class="pdca-wrap max-w-2xl mx-auto">
                    
                    <div class="pdca-grid">
                        
                        <!-- P. Plan (Top Left) -->
                        <div class="card pdca-step pdca-P grid-P">
                            <span class="text-6xl font-extrabold mb-1">P</span>
                            <h3 class="font-bold text-xl">–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Plan)</h3>
                            <p class="text-sm opacity-90">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–π –∏ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ –¥–ª—è –∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.</p>
                        </div>

                        <!-- D. Do (Top Right) -->
                        <div class="card pdca-step pdca-D grid-D">
                            <span class="text-6xl font-extrabold mb-1">D</span>
                            <h3 class="font-bold text-xl">–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (Do)</h3>
                            <p class="text-sm opacity-90">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏ —Ñ–∏–∫—Å–∞—Ü–∏—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –≤–æ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–∞.</p>
                        </div>
                        
                        <!-- A. Act (Bottom Left) -->
                        <div class="card pdca-step pdca-A grid-A">
                            <span class="text-6xl font-extrabold mb-1">A</span>
                            <h3 class="font-bold text-xl">–î–µ–π—Å—Ç–≤–∏–µ (Act)</h3>
                            <p class="text-sm opacity-90">–í–Ω–µ—Å–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–ª–∏ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä —Å–∞–º–æ–≥–æ –±—é–¥–∂–µ—Ç–∞ (Rolling Forecast).</p>
                        </div>

                        <!-- C. Check (Bottom Right) -->
                        <div class="card pdca-step pdca-C grid-C">
                            <span class="text-6xl font-extrabold mb-1">C</span>
                            <h3 class="font-bold text-xl">–ü—Ä–æ–≤–µ—Ä–∫–∞ (Check)</h3>
                            <p class="text-sm opacity-90">–ü–ª–∞–Ω-—Ñ–∞–∫—Ç –∞–Ω–∞–ª–∏–∑ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–ø—Ä–∏—á–∏–Ω –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π (Drill-Down).</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- –°–ï–ö–¶–ò–Ø V: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö -->
            <section id="conclusion">
                <h2 class="text-2xl md:text-3xl font-bold text-center mb-6 text-[#003f5c]">V. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö</h2>
                <div class="card p-8 bg-[#58508d] text-white text-center">
                    <span class="text-6xl mb-4 block">üéØ</span>
                    <h3 class="text-2xl font-bold mb-3">–ì–ª–∞–≤–Ω—ã–π –í—ã–≤–æ–¥</h3>
                    <p class="text-lg mb-6">–ë—é–¥–∂–µ—Ç - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è. OLAP –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –ø–ª–∞–Ω-—Ñ–∞–∫—Ç –∞–Ω–∞–ª–∏–∑ –≤ —Å–∏—Å—Ç–µ–º—É –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π, –ø–æ–∑–≤–æ–ª—è—è –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏, –Ω–æ –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∏—Å–∫–∞—Ç—å –∏—Ö –ø—Ä–∏—á–∏–Ω—ã (Drill-Down).</p>
                    
                    <div class="flex justify-around items-center mt-6">
                        <div class="w-1/3">
                            <p class="text-4xl font-extrabold text-[#ffa600]">99%</p>
                            <p class="text-sm font-semibold mt-1">–°–∫–æ—Ä–æ—Å—Ç—å Drill-Down</p>
                        </div>
                        <div class="w-1/3">
                            <p class="text-4xl font-extrabold text-[#ff6361]">4x</p>
                            <p class="text-sm font-semibold mt-1">–ë—ã—Å—Ç—Ä–µ–µ —Ü–∏–∫–ª –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</p>
                        </div>
                        <div class="w-1/3">
                            <p class="text-4xl font-extrabold text-[#6ac1e3]">1</p>
                            <p class="text-sm font-semibold mt-1">–ï–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏—Å—Ç–∏–Ω—ã</p>
                        </div>
                    </div>
                </div>
            </section>

        </main>
        
        <!-- –§—É—Ç–µ—Ä -->
        <footer class="text-center mt-12 py-6 border-t border-gray-300">
            <p class="text-gray-600">–ë—é–¥–∂–µ—Ç - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –ø–ª–∞–Ω-—Ñ–∞–∫—Ç –∞–Ω–∞–ª–∏–∑ - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –µ—é. OLAP –¥–µ–ª–∞–µ—Ç —ç—Ç–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º –∏ —Ç–æ—á–Ω—ã–º.</p>
            
            <div class="mt-6">
                <a href="https://yarsuleimenov-code.github.io/IITU_OLAP_Course/"
                   class="inline-flex items-center px-6 py-3 bg-sky-600 text-white rounded-lg shadow hover:bg-sky-700 transition duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –ª–µ–∫—Ü–∏–π
                </a>
            </div>
        </footer>

    </div>

    <script>
        const chartColors = {
            darkBlue: '#003f5c',
            purple: '#58508d',
            red: '#ff6361',
            orange: '#ffa600',
            textColor: 'rgba(0, 0, 0, 0.8)',
            gridColor: 'rgba(0, 0, 0, 0.1)'
        };

        /**
         * –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö.
         * @param {string} label - –ü–æ–¥–ø–∏—Å—å –≥—Ä–∞—Ñ–∏–∫–∞.
         * @returns {string|string[]} - –ü–æ–¥–ø–∏—Å—å –∏–ª–∏ –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞.
         */
        const wrapLabel = (label) => {
            const maxLength = 16;
            if (typeof label !== 'string' || label.length <= maxLength) {
                return label;
            }
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + ' ' + word).trim().length > maxLength) {
                    lines.push(currentLine.trim());
                    currentLine = word;
                } else {
                    currentLine = (currentLine + ' ' + word).trim();
                }
            }
            if (currentLine) {
                lines.push(currentLine.trim());
            }
            return lines;
        };
        
        /**
         * Callback –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏ Chart.js.
         * @param {object[]} tooltipItems - –≠–ª–µ–º–µ–Ω—Ç—ã –ø–æ–¥—Å–∫–∞–∑–∫–∏.
         * @returns {string} - –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫.
         */
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Chart.js
        const defaultChartOptions = {
            maintainAspectRatio: false,
            responsive: true,
            plugins: {
                legend: {
                    labels: {
                        color: chartColors.textColor
                    }
                },
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { color: chartColors.textColor },
                    grid: { color: chartColors.gridColor }
                },
                x: {
                    ticks: { color: chartColors.textColor },
                    grid: { color: chartColors.gridColor }
                }
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –ü–ª–∞–Ω-–§–∞–∫—Ç
        const ctxPlanFact = document.getElementById('planFactChart');
        if (ctxPlanFact) {
            new Chart(ctxPlanFact, {
                type: 'bar',
                data: {
                    labels: [
                        '–í—ã—Ä—É—á–∫–∞', 
                        '–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å', 
                        '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–¥—ã', 
                        '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã'
                    ].map(wrapLabel),
                    datasets: [
                        {
                            label: '–ü–ª–∞–Ω (—Ç—ã—Å. $)',
                            data: [3500, 1500, 450, 600],
                            backgroundColor: chartColors.darkBlue,
                        },
                        {
                            label: '–§–∞–∫—Ç (—Ç—ã—Å. $)',
                            data: [3150, 1650, 500, 550],
                            backgroundColor: chartColors.orange,
                        }
                    ]
                },
                options: {
                    ...defaultChartOptions,
                    indexAxis: 'y', // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞
                    scales: {
                        x: {
                            ...defaultChartOptions.scales.x,
                            title: { display: true, text: '–°—É–º–º–∞ (—Ç—ã—Å. $)' },
                            ticks: {
                                callback: function(value) { return value + 'K'; }
                            }
                        },
                        y: {
                            ...defaultChartOptions.scales.y,
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        ...defaultChartOptions.plugins,
                        tooltip: {
                            callbacks: {
                                title: tooltipTitleCallback,
                                // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –≤ —Ñ—É—Ç–µ—Ä–µ
                                footer: (tooltipItems) => {
                                    const plannedItem = tooltipItems.find(item => item.dataset.label === '–ü–ª–∞–Ω (—Ç—ã—Å. $)');
                                    const actualItem = tooltipItems.find(item => item.dataset.label === '–§–∞–∫—Ç (—Ç—ã—Å. $)');
                                    
                                    if (plannedItem && actualItem) {
                                        const plan = plannedItem.parsed.x;
                                        const actual = actualItem.parsed.x;
                                        const delta = actual - plan;
                                        const percent = (delta / plan) * 100;
                                        
                                        const sign = delta >= 0 ? '+' : '';
                                        const color = delta >= 0 ? ' (–ü–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥)' : ' (–≠–∫–æ–Ω–æ–º–∏—è)';
                                        
                                        return [
                                            `–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (Œî): ${sign}${delta.toFixed(0)}K $`,
                                            `% –æ—Ç –ü–ª–∞–Ω–∞: ${sign}${percent.toFixed(1)}%` + color
                                        ];
                                    }
                                    return ''; 
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
